{
	"TODO": ["who won?"],
	"source": "http://www.di.fc.ul.pt/~jpn/gv/conquest.htm",
	"board": {
		"height": 9,
		"width": 9
	},
	"terrain": {
		"center": [{"pos":5005}],
		"plus": [ ["ALL",[4005,5004,5006,6005],{}] ],
		"x": [ ["ALL",[4004,4006,6004,6006],{}] ]
	},
	"setup": [
		["ALL",[1001,1002,1003,2001,2003,3001,3002,3003],{"type":"soldier","owner":1}],
		{"pos":2002,"type":"king","owner":1},
		["ALL",[7007,7008,7009,8007,8009,9007,9008,9009],{"type":"soldier","owner":2}],
		{"pos":8008,"type":"king","owner":2}
	],
	"marks": {
		"selectunit": {
			"fromlayer": "freetomove",
			"condition": ["not",["hasperformedcommand","move"]],
			"hydration": ["findmovetargets"],
			"cleanse": ["movetargets"]
		},
		"selectmove": {
			"fromlayer": "movetargets",
			"condition": ["not",["hasperformedcommand","move"]]
		},
		"selectexilee": {
			"condition": ["hasperformedcommand","move"],
			"fromlayer": "exiletargets",
			"hydration": ["findexiledestinations"],
			"cleanse": ["exiledestinations"]
		}
	},
	"commands": {
		"move": {
			"neededmarks": ["selectunit","selectmove"],
			"condition": ["not",["hasperformedcommand","move"]]
		},
		"exile": {
			"neededmarks": ["selectexiletarget","selectexiledestination"],
			"condition": ["and",
				["hasperformedcommand","move"]
			]
		}
	},
	"startstep": {
		"hydration": ["findexiletargets"]
	},
	"startturn": {
		"hydration": ["findmovers"]
	},
	"endturn": {
		"condition": ["hasperformedcommand","move"],
		"endgame": {
			"madepattern": {
				"hydration": ["findcenterking","findplussers","findexers"],
				"condition": ["and",
					["notEMPY",["layername","centerking"]],
					["or",
						["same",["layerobjectcount",["layername","plussers"]],["val",4]],
						["same",["layerobjectcount",["layername","exers"]],["val",4]]
					]
				]
			}
		}
	},
	"generators": {
		"findexiletargets": {
			"type": "walker",
			"dirs": ["dirs",[2,4,6,8]],
			"max": 2,
			"starts": ["markinlast","move","selectunit"],
			"steps": "OPPunits",
			"blocks": "MYunits",
			"draw": {
				"step": {
					"condition": ["and",
						["same",["contextval","stopreason"],"hitblock"],
						["not",["affected",["idofunitat",["contextpos","target"]]]]
					],
					"tolayer": "exiletargets"
				}
			}
		},
		"findmovers": {
			"type": "nextto",
			"dirs": ["dirs",[2,4,6,8]],
			"from": ["ALLposIN","MYunits"],
			"draw": {
				"start": {
					"condition": ["different",["contextval","neighbourcount"],0],
					"tolayer": "freetomove"
				},
				"target": {
					"condition": ["noneat","units",["contextpos","target"]],
					"tolayer": "potmovetargets",
					"include": {
						"moverid": ["idofunitat",["contextpos","start"]]
					}
				}
			}
		},
		"findmovetargets": {
			"type": "filter",
			"layer": "potmovetargets",
			"matching": {"moverid":["idofunitat",["markpos","selectunit"]]},
			"tolayer": "movetargets"
		},
		"findexiledestinations": {
			"type": "filter",
			"layer": ["ifelse", ["same",["lookup","BOARD",["markpos","selectexiletarget"],"color"],"light"],"LIGHT","DARK"],
			"condition": ["noneat", ["units"],["contextpos","start"]],
			"tolayer": ["exiledestinations"]
		},
		"findcenterking": {
			"type": "filter",
			"layer": "MYunits",
			"matching": {"type":"king"},
			"condition": ["anyat",["layername","center"],["contextpos","start"]],
			"tolayer": ["layername","centerking"]
		},
		"findplussers": {
			"type": "filter",
			"layer": "MYunits",
			"condition": ["anyat",["layername","plus"],["contextpos","start"]],
			"tolayer": ["layername","plussers"]
		},
		"findexers": {
			"type": "filter",
			"layer": "MYunits",
			"condition": ["anyat",["layername","x"],["contextpos","start"]],
			"tolayer": ["layername","exers"]
		}

	}
}