{
	"TODO": ["who won?"],
	"source": "http://www.di.fc.ul.pt/~jpn/gv/conquest.htm",
	"board": {
		"height": 9,
		"width": 9
	},
	"terrain": {
		"center": [{"POS":5005}],
		"plus": [ ["ALL",[4005,5004,5006,6005],{}] ],
		"x": [ ["ALL",[4004,4006,6004,6006],{}] ]
	},
	"setup": [
		["ALL",[1001,1002,1003,2001,2003,3001,3002,3003],{"type":"soldier","PLR":1}],
		{"POS":2002,"type":"king","PLR":1},
		["ALL",[7007,7008,7009,8007,8009,9007,9008,9009],{"type":"soldier","PLR":2}],
		{"POS":8008,"type":"king","PLR":2}
	],
	"marks": {
		"selectunit": {
			"fromlayer": "freetomove",
			"condition": ["NOT",["HASPERFORMEDCOMMAND","move"]],
			"hydration": ["findmovetargets"],
			"cleanse": ["movetargets"]
		},
		"selectmove": {
			"fromlayer": "movetargets",
			"condition": ["NOT",["HASPERFORMEDCOMMAND","move"]]
		},
		"selectexilee": {
			"condition": ["HASPERFORMEDCOMMAND","move"],
			"fromlayer": "exiletargets",
			"hydration": ["findexiledestinations"],
			"cleanse": ["exiledestinations"]
		}
	},
	"commands": {
		"move": {
			"neededmarks": ["selectunit","selectmove"],
			"condition": ["NOT",["HASPERFORMEDCOMMAND","move"]]
		},
		"exile": {
			"neededmarks": ["selectexiletarget","selectexiledestination"],
			"condition": ["AND",
				["HASPERFORMEDCOMMAND","move"]
			]
		}
	},
	"startstep": {
		"hydration": ["findexiletargets"]
	},
	"startturn": {
		"hydration": ["findmovers"]
	},
	"endturn": {
		"condition": ["HASPERFORMEDCOMMAND","move"],
		"endgame": {
			"madepattern": {
				"hydration": ["findcenterking","findplussers","findexers"],
				"condition": ["AND",
					["NOTEMPY",["LAYERNAME","centerking"]],
					["OR",
						["SAME",["COUNT",["LAYERNAME","plussers"]],["VAL",4]],
						["SAME",["COUNT",["LAYERNAME","exers"]],["VAL",4]]
					]
				]
			}
		}
	},
	"generators": {
		"findexiletargets": {
			"type": "walker",
			"dirs": ["DIRS",[2,4,6,8]],
			"max": 2,
			"starts": ["MARKINLAST","move","selectunit"],
			"steps": "OPPUNITS",
			"blocks": "MYUNITS",
			"draw": {
				"step": {
					"condition": ["AND",
						["SAME",["CONTEXTVAL","STOPREASON"],"HITBLOCK"],
						["NOT",["AFFECTED",["IDAT",["CONTEXTPOS","TARGET"]]]]
					],
					"tolayer": "exiletargets"
				}
			}
		},
		"findmovers": {
			"type": "nextto",
			"dirs": ["DIRS",[2,4,6,8]],
			"from": ["ALLPOSIN","MYUNITS"],
			"draw": {
				"start": {
					"condition": ["DIFFERENT",["CONTEXTVAL","NEIGHBOURS"],0],
					"tolayer": "freetomove"
				},
				"target": {
					"condition": ["NONEAT","UNITS",["CONTEXTPOS","TARGET"]],
					"tolayer": "potmovetargets",
					"include": {
						"moverid": ["IDAT",["CONTEXTPOS","START"]]
					}
				}
			}
		},
		"findmovetargets": {
			"type": "filter",
			"layer": "potmovetargets",
			"matching": {"moverid":["IDAT",["MARKPOS","selectunit"]]},
			"tolayer": "movetargets"
		},
		"findexiledestinations": {
			"type": "filter",
			"layer": ["IFELSE", ["SAME",["LOOKUP","BOARD",["MARKPOS","selectexiletarget"],"color"],"light"],"LIGHT","DARK"],
			"condition": ["NONEAT", ["UNITS"],["CONTEXTPOS","START"]],
			"tolayer": ["exiledestinations"]
		},
		"findcenterking": {
			"type": "filter",
			"layer": "MYUNITS",
			"matching": {"type":"king"},
			"condition": ["ANYAT",["LAYERNAME","center"],["CONTEXTPOS","START"]],
			"tolayer": ["LAYERNAME","centerking"]
		},
		"findplussers": {
			"type": "filter",
			"layer": "MYUNITS",
			"condition": ["ANYAT",["LAYERNAME","plus"],["CONTEXTPOS","START"]],
			"tolayer": ["LAYERNAME","plussers"]
		},
		"findexers": {
			"type": "filter",
			"layer": "MYUNITS",
			"condition": ["ANYAT",["LAYERNAME","x"],["CONTEXTPOS","START"]],
			"tolayer": ["LAYERNAME","exers"]
		}

	}
}