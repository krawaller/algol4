{
	"source": "http://www.di.fc.ul.pt/~jpn/gv/Archers.pdf",
	"board": {
		"height": 9,
		"width": 9,
		"terrain": [
			{"pos":2002,"type":"base","PLR":1},{"pos":2003,"type":"base","PLR":1},{"pos":2004,"type":"base","PLR":1},
			{"pos":3002,"type":"base","PLR":1},{"pos":3003,"type":"base","PLR":1},{"pos":3004,"type":"base","PLR":1},
			{"pos":4002,"type":"base","PLR":1},{"pos":4003,"type":"base","PLR":1},{"pos":4004,"type":"base","PLR":1},
			{"pos":6006,"type":"base","PLR":2},{"pos":6007,"type":"base","PLR":2},{"pos":6008,"type":"base","PLR":2},
			{"pos":7006,"type":"base","PLR":2},{"pos":7007,"type":"base","PLR":2},{"pos":7008,"type":"base","PLR":2},
			{"pos":8006,"type":"base","PLR":2},{"pos":8007,"type":"base","PLR":2},{"pos":8008,"type":"base","PLR":2}
		],
		"setup": [
			{"POS":2002,"type":"archer","DIR":5,"PLR":1},{"POS":2003,"type":"archer","DIR":5,"PLR":1},{"POS":2004,"type":"archer","DIR":5,"PLR":1},
			{"POS":3002,"type":"archer","DIR":5,"PLR":1},{"POS":3003,"type":"king","DIR":5,"PLR":1},{"POS":3004,"type":"archer","DIR":5,"PLR":1},
			{"POS":4002,"type":"archer","DIR":5,"PLR":1},{"POS":4003,"type":"archer","DIR":5,"PLR":1},{"POS":4004,"type":"archer","DIR":5,"PLR":1},
			{"POS":6006,"type":"archer","DIR":1,"PLR":2},{"POS":6007,"type":"archer","DIR":1,"PLR":2},{"POS":6008,"type":"archer","DIR":1,"PLR":2},
			{"POS":7006,"type":"archer","DIR":1,"PLR":2},{"POS":7007,"type":"king","DIR":1,"PLR":2},{"POS":7008,"type":"archer","DIR":1,"PLR":2},
			{"POS":8006,"type":"archer","DIR":1,"PLR":2},{"POS":8007,"type":"archer","DIR":1,"PLR":2},{"POS":8008,"type":"archer","DIR":1,"PLR":2}
		]
	},
	"generators": {
		"findinfiltrators": {
			"type": "filter",
			"layer": "TERRAIN",
			"overlapping": "MYUNITS",
			"matching": {"PLR":["ISNT",["CONTEXTVAL","CURRENTPLAYER"]]},
			"tolayer": "infiltrators"
		},
		"findkilltargets": {
			"type": "filter",
			"layer": "bullseye",
			"matching": {"shooterid":["IS",["IDAT",["MARKPOS","selectunit"]]]},
			"tolayer": "gonnadie"
		},
		"finddeadkings": {
			"type": "filter",
			"layer": "DEADUNITS",
			"matching": {
				"type": ["IS",["VAL","crown"]]
			},
			"tolayer": "deadking"
		},
		"findarrows": {
			"type": "walker",
			"starts": ["FROMALLINLAYER","UNITS"],
			"dir": ["RELATIVEDIR",["VAL",1],["LOOKUP","UNITS",["CONTEXTPOS","START"],"DIR"]],
			"stops": "UNITS",
			"max": 3,
			"draw": {
				"step": {
					"tolayer": ["IFELSE",["SAME",["LOOKUP","UNITS",["CONTEXTPOS","START"],"PLR"],["CONTEXTVAL","CURRENTPLAYER"]],"myarrows","opparrows"]
				},
				"stop": {
					"condition": ["AND",
						["ANYAT","UNITS",["CONTEXTPOS","TARGET"]],
						["DIFFERENT",
							["LOOKUP","UNITS",["CONTEXTPOS","TARGET"],"PLR"],
							["LOOKUP","UNITS",["CONTEXTPOS","START"],"PLR"]
						]
					],
					"tolayer": "bullseye",
					"include": {
						"shooterid": ["IDAT",["CONTEXTPOS","START"]]
					}
				}
			}
		},
		"findfooting": {
			"type": "nextto",
			"start": ["FROMMARK","selectunit"],
			"dirs": ["RELATIVEDIRS",["DIRS",1,5],["LOOKUP","UNITS",["CONTEXTPOS","START"],"DIR"]],
			"drawtarget": {
				"condition": ["AND",["NONEAT","UNITS",["CONTEXTPOS","TARGET"]],["NONEAT","opparrows",["CONTEXTPOS","TARGET"]]],
				"layer": ["IFELSE",["SAME",["CONTEXTVAL","DIR"],["LOOKUP","UNITS",["CONTEXTPOS","START"],"DIR"]],"forwardfooting","backwardfooting"],
				"include": {
					"id": ["IDAT","START"]
				}
			}
		}
	},
	"marks": {
		"selectunit": {
			"from":["FROMALLINLAYER","MYUNITS"]
		}
	},
	"endturn": {
		"condition":["SAME",["CONTEXTVAL","PERFORMEDSTEPS"],2],
		"commandcap": true
	},
	"endgame": {
		"infiltration":[["NOTEMPTY","infiltrators"],["CONTEXTVAL","CURRENTPLAYER"]],
		"kingkill":[["NOTEMPTY","deadking"],["CONTEXTVAL","CURRENTPLAYER"]]
	},
	"commands": {
		"stepforward": {
			"condition": ["NOTEMPTY","forwardfooting"],
			"effect": ["MOVEUNIT",["IDAT","selectunit"],["ONLYPOSIN","forwardfooting"]],
			"setmarks": {
				"selectunit": ["ONLYPOSIN","forwardfooting"]
			}
		},
		"stepbackward": {
			"condition": ["NOTEMPTY","backwardfooting"],
			"effect": ["MOVEUNIT",["IDAT","selectunit"],["ONLYPOSIN","backwardfooting"]],
			"setmarks": {
				"selectunit": ["ONLYPOSIN","forwardfooting"]
			}
		},
		"turnleft": {
			"effect": ["TURNUNIT",["IDAT","selectunit"],-1]
		},
		"turnright": {
			"effect": ["TURNUNIT",["IDAT","selectunit"],1]
		},
		"fire": {
			"condition": ["AND",["NOTEMPTY","gonnadie"],["NOT",["AFFECTED",["IDAT","selectunit"]]]],
			"effect": ["KILLUNIT",["IDAT",["ONLYPOSIN","gonnadie"]]]
		}
	}
}