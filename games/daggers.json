{
	"source": "http://www.di.fc.ul.pt/~jpn/gv/daggers.htm",
	"board": {
		"height": 8,
		"width": 8
	},
	"terrain": {
		"bases": [
			["ALL",[1001,1002,1003,1004,1005,1006,1007,1008],{"owner":1}],
			["ALL",[8001,8002,8003,8004,8005,8006,8007,8008],{"owner":2}]
		]
	},
	"setup": [
		["ALL",[1004,1005],{"PLR":1,"type":"crown"}],
		["ALL",[2003,2004,2005,2006],{"PLR":1,"type":"dagger"}],
		["ALL",[6003,6006,7002,7003,7004,7005,7006,7007],{"PLR":2,"type":"dagger"}],
		["ALL",[8003,8006],{"PLR":2,"type":"crown"}]
	],
	"endturn": {
		"condition":["PERFORMEDANYCOMMAND"],
		"commandcap": true,
		"endgame": {
			"infiltration":{
				"hydration": ["findinfiltrators"],
				"condition": [["NOTEMPTY","infiltrator"],["CONTEXTVAL","CURRENTPLAYER"]]
			},
			"kingkill": {
				"hydration": ["finddeadkings"],
				"condition": [["NOTEMPTY","deadking"],["CONTEXTVAL","CURRENTPLAYER"]]
			}
		}
	},
	"marks": {
		"selectunit": {
			"fromlayer":"MYUNITS"
		},
		"selectmovetarget": {
			"fromlayer": "movetarget",
			"notwith": ["selectkilltarget"]
		},
		"selectkilltarget": {
			"fromlayer": "killtarget",
			"notith": ["selectmovetarget"]
		}
	},
	"commands": {
		"move": {
			"effects": [
				["MOVEUNIT",["IDAT",["MARKPOS","selectunit"]],["MARKPOS","selectmovetarget"]]
			]
		},
		"kill": {
			"effects": [
				["KILLUNIT",["IDAT",["MARKPOS","selectkilltarget"]]],
				["MOVEUNIT",["IDAT",["MARKPOS","selectunit"]],["MARKPOS","selectkilltarget"]]
			]
		}
	},
	"generators": {
		"finddeadkings": {
			"type": "filter",
			"layer": "DEADUNITS",
			"matching": {"type":["IS",["VAL","crown"]],"plr":["ISNT",["CONTEXTVAL","CURRENTPLAYER"]]},
			"tolayer": "deadking"
		},
		"activeunittype": {
			"type": "spawn",
			"start": ["FROMMARK","selectunit"],
			"drawstart": {
				"tolayer": ["IFELSE",
					["SAME",
						["LOOKUP","UNITS",["CONTEXTPOS","START"],"type"],
						["VAL","crown"]
					],
					"activecrown","activedagger"
				]
			}
		},
		"findinfiltrators": {
			"type": "filter",
			"layer": "TERRAIN",
			"overlapping": "MYUNITS",
			"matching": { "plr": ["ISNT",["CONTEXTVAL","CURRENTPLAYER"]] },
			"tolayer": "infiltrator"
		},
		"nexttocrown": {
			"type": "nextto",
			"starts": ["FROMALLINLAYER","activecrown"],
			"dirs": ["DIRS",[1,2,3,4,5,6,7,8]],
			"drawtarget": {
				"condition": ["NONEAT","MYUNITS","TARGET"],
				"tolayer": ["IFELSE",["ANYAT","OPPUNITS","TARGET"],"killtarget","movetarget"]
			}
		},
		"abovedagger": {
			"type": "nextto",
			"starts": ["FROMALLINLAYER","activedagger"],
			"dirs": ["DIRS",[8,1,2]],
			"drawtarget": {
				"condition": ["AND",
					["NONEAT","MYUNITS",["CONTEXTPOS","TARGET"]],
					["NOT",["AND",
						["SAME",["CONTEXTVAL","DIR"],["VAL",1]],
						["SAME",["LOOKUP","OPPUNITS",["CONTEXTPOS","TARGET"],"type"],"dagger"]
					]]
				],
				"tolayer": ["IFELSE",["ANYAT","UNITS",["CONTEXTPOS","TARGET"]],"killtarget","movetarget"]
			}
		},
		"belowdagger": {
			"type": "walker",
			"starts": ["FROMALLINLAYER","activedagger"],
			"dirs": ["DIRS",[4,5,6]],
			"stoplayer": "UNITS",
			"drawstep": {
				"tolayer": "movetarget"
			},
			"drawstop": {
				"condition": ["AND",
					["NONEAT","MYUNITS",["CONTEXTPOS","TARGET"]],
					["NOT",["AND",
						["SAME",["CONTEXTVAL","DIR"],["VAL",5]],
						["SAME",["LOOKUP","UNITS",["CONTEXTPOS","TARGET"],"type"],["VAL","dagger"]]
					]]
				],
				"tolayer": ["IFELSE",
					["ANYAT","UNITS",["CONTEXTPOS","TARGET"]],
					["LAYERNAME","killtarget"],
					["LAYERNAME","movetarget"]
				]
			}
		}
	}
}