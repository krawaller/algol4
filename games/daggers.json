{
	"source": "http://www.di.fc.ul.pt/~jpn/gv/daggers.htm",
	"board": {
		"height": 8,
		"width": 8
	},
	"terrain": {
		"bases": [
			["ALL",[1001,1002,1003,1004,1005,1006,1007,1008],{"owner":1}],
			["ALL",[8001,8002,8003,8004,8005,8006,8007,8008],{"owner":2}]
		]
	},
	"setup": [
		["ALL",[1004,1005],{"PLR":1,"type":"crown"}],
		["ALL",[2003,2004,2005,2006],{"PLR":1,"type":"dagger"}],
		["ALL",[6003,6006,7002,7003,7004,7005,7006,7007],{"PLR":2,"type":"dagger"}],
		["ALL",[8003,8006],{"PLR":2,"type":"crown"}]
	],
	"endturn": {
		"condition":["performedanycommand"],
		"commandcap": true,
		"endgame": {
			"infiltration":{
				"hydration": ["findinfiltrators"],
				"condition": [["notempty","infiltrator"],["contextval","currentplayer"]]
			},
			"kingkill": {
				"hydration": ["finddeadkings"],
				"condition": [["notempty","deadking"],["contextval","currentplayer"]]
			}
		}
	},
	"marks": {
		"selectunit": {
			"fromlayer":"MYunits"
		},
		"selectmovetarget": {
			"fromlayer": "movetarget",
			"notwith": ["selectkilltarget"]
		},
		"selectkilltarget": {
			"fromlayer": "killtarget",
			"notith": ["selectmovetarget"]
		}
	},
	"commands": {
		"move": {
			"effects": [
				["moveunit",["idofunitat",["markpos","selectunit"]],["markpos","selectmovetarget"]]
			]
		},
		"kill": {
			"effects": [
				["killunit",["idofunitat",["markpos","selectkilltarget"]]],
				["moveunit",["idofunitat",["markpos","selectunit"]],["markpos","selectkilltarget"]]
			]
		}
	},
	"generators": {
		"finddeadkings": {
			"type": "filter",
			"layer": "DEADunits",
			"matching": {"type":["is",["val","crown"]],"plr":["isnt",["contextval","currentplayer"]]},
			"tolayer": "deadking"
		},
		"activeunittype": {
			"type": "spawn",
			"start": ["FROMMARK","selectunit"],
			"drawstart": {
				"tolayer": ["ifelse",
					["same",
						["lookup","units",["contextpos","start"],"type"],
						["val","crown"]
					],
					"activecrown","activedagger"
				]
			}
		},
		"findinfiltrators": {
			"type": "filter",
			"layer": "TERRAIN",
			"overlapping": "MYunits",
			"matching": { "plr": ["isnt",["contextval","currentplayer"]] },
			"tolayer": "infiltrator"
		},
		"nexttocrown": {
			"type": "nextto",
			"starts": ["FROMALLINLAYER","activecrown"],
			"dirs": ["dirs",[1,2,3,4,5,6,7,8]],
			"drawtarget": {
				"condition": ["noneat","MYunits","target"],
				"tolayer": ["ifelse",["anyat","OPPunits","target"],"killtarget","movetarget"]
			}
		},
		"abovedagger": {
			"type": "nextto",
			"starts": ["FROMALLINLAYER","activedagger"],
			"dirs": ["dirs",[8,1,2]],
			"drawtarget": {
				"condition": ["and",
					["noneat","MYunits",["contextpos","target"]],
					["not",["and",
						["same",["contextval","dir"],["val",1]],
						["same",["lookup","OPPunits",["contextpos","target"],"type"],"dagger"]
					]]
				],
				"tolayer": ["ifelse",["anyat","units",["contextpos","target"]],"killtarget","movetarget"]
			}
		},
		"belowdagger": {
			"type": "walker",
			"starts": ["FROMALLINLAYER","activedagger"],
			"dirs": ["dirs",[4,5,6]],
			"stoplayer": "units",
			"drawstep": {
				"tolayer": "movetarget"
			},
			"drawstop": {
				"condition": ["and",
					["noneat","MYunits",["contextpos","target"]],
					["not",["and",
						["same",["contextval","dir"],["val",5]],
						["same",["lookup","units",["contextpos","target"],"type"],["val","dagger"]]
					]]
				],
				"tolayer": ["ifelse",
					["anyat","units",["contextpos","target"]],
					["layername","killtarget"],
					["layername","movetarget"]
				]
			}
		}
	}
}