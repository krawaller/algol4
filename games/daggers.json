{
	"source": "http://www.di.fc.ul.pt/~jpn/gv/daggers.htm",
	"board": {
		"height": 8,
		"width": 8,
		"terrain": {
			"bases": {
				"1001": {"owner":1}, "1002": {"owner":1}, "1003": {"owner":1}, "1004": {"owner":1}, "1005": {"owner":1}, "1006": {"owner":1}, "1007": {"owner":1}, "1008": {"owner":1},
				"8001": {"owner":2}, "8002": {"owner":2}, "8003": {"owner":2}, "8004": {"owner":2}, "8005": {"owner":2}, "8006": {"owner":2}, "8007": {"owner":2}, "8008": {"owner":2}
			}
		},
		"setup": [
			{"pos":1004,"plr":1,"type":"crown"},{"pos":1005,"plr":1,"type":"crown"},
			{"pos":2003,"plr":1,"type":"dagger"},{"pos":2004,"plr":1,"type":"dagger"},{"pos":2005,"plr":1,"type":"dagger"},{"pos":2006,"plr":1,"type":"dagger"},
			{"pos":6003,"plr":2,"type":"dagger"},{"pos":6006,"plr":2,"type":"dagger"},
			{"pos":7002,"plr":2,"type":"dagger"},{"pos":7003,"plr":2,"type":"dagger"},{"pos":7004,"plr":2,"type":"dagger"},{"pos":7005,"plr":2,"type":"dagger"},{"pos":7006,"plr":2,"type":"dagger"},{"pos":7007,"plr":2,"type":"dagger"},
			{"pos":8003,"plr":2,"type":"crown"},{"pos":8006,"plr":2,"type":"crown"}
		]
	},
	"endturn": {
		"condition":["PERFORMEDANYCOMMAND"],
		"commandcap": true,
		"endgame": {
			"infiltration":{
				"hydration": ["findinfiltrators"],
				"condition": [["NOTEMPTY","infiltrator"],["CONTEXTVAL","CURRENTPLAYER"]]
			},
			"kingkill": {
				"hydration": ["finddeadkings"],
				"condition": [["NOTEMPTY","deadking"],["CONTEXTVAL","CURRENTPLAYER"]]
			}
		}
	},
	"marks": {
		"selectunit": {
			"fromlayer":"MYUNITS"
		},
		"selectmovetarget": {
			"fromlayer": "movetarget",
			"notwith": "selectkilltarget"
		},
		"selectkilltarget": {
			"fromlayer": "killtarget"
		}
	},
	"commands": {
		"move": {
			"effects": [
				["MOVEUNIT",["IDAT",["MARKPOS","selectunit"]],["MARKPOS","selectmovetarget"]]
			]
		},
		"kill": {
			"effects": [
				["KILLUNIT",["IDAT",["MARKPOS","selectkilltarget"]]],
				["MOVEUNIT",["IDAT",["MARKPOS","selectunit"]],["MARKPOS","selectkilltarget"]]
			]
		}
	},
	"generators": {
		"finddeadkings": {
			"type": "filter",
			"layer": "DEADUNITS",
			"matching": {"type":["IS",["VAL","crown"]],"plr":["ISNT",["CONTEXTVAL","CURRENTPLAYER"]]},
			"tolayer": "deadking"
		},
		"activeunittype": {
			"type": "spawn",
			"start": ["FROMMARK","selectunit"],
			"drawstart": {
				"tolayer": ["IFELSE",
					["SAME",
						["LOOKUP","UNITS",["CONTEXTPOS","START"],"type"],
						["VAL","crown"]
					],
					"activecrown","activedagger"
				]
			}
		},
		"findinfiltrators": {
			"type": "filter",
			"layer": "TERRAIN",
			"overlapping": "MYUNITS",
			"matching": { "plr": ["ISNT",["CONTEXTVAL","CURRENTPLAYER"]] },
			"tolayer": "infiltrator"
		},
		"nexttocrown": {
			"type": "nextto",
			"starts": ["FROMALLINLAYER","activecrown"],
			"dirs": ["DIRS",[1,2,3,4,5,6,7,8]],
			"drawtarget": {
				"condition": ["NONEAT","MYUNITS","TARGET"],
				"tolayer": ["IFELSE",["ANYAT","OPPUNITS","TARGET"],"killtarget","movetarget"]
			}
		},
		"abovedagger": {
			"type": "nextto",
			"starts": ["FROMALLINLAYER","activedagger"],
			"dirs": ["DIRS",[8,1,2]],
			"drawtarget": {
				"condition": ["AND",
					["NONEAT","MYUNITS",["CONTEXTPOS","TARGET"]],
					["NOT",["AND",
						["SAME",["CONTEXTVAL","DIR"],["VAL",1]],
						["SAME",["LOOKUP","OPPUNITS",["CONTEXTPOS","TARGET"],"type"],"dagger"]
					]]
				],
				"tolayer": ["IFELSE",["ANYAT","UNITS",["CONTEXTPOS","TARGET"]],"killtarget","movetarget"]
			}
		},
		"belowdagger": {
			"type": "walker",
			"starts": ["FROMALLINLAYER","activedagger"],
			"dirs": ["DIRS",[4,5,6]],
			"stoplayer": "UNITS",
			"drawstep": {
				"tolayer": "movetarget"
			},
			"drawstop": {
				"condition": ["AND",
					["NONEAT","MYUNITS",["CONTEXTPOS","TARGET"]],
					["NOT",["AND",
						["SAME",["CONTEXTVAL","DIR"],["VAL",5]],
						["SAME",["LOOKUP","UNITS",["CONTEXTPOS","TARGET"],"type"],["VAL","dagger"]]
					]]
				],
				"tolayer": ["IFELSE",
					["ANYAT","UNITS",["CONTEXTPOS","TARGET"]],
					["LAYERNAME","killtarget"],
					["LAYERNAME","movetarget"]
				]
			}
		}
	}
}